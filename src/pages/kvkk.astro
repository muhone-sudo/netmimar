---
import BaseLayout from "../layouts/BaseLayout.astro";
import { getReader } from "../lib/reader";
import { DocumentRenderer } from "@keystatic/core/renderer";

let kvkkContent: any = null;
try {
    const reader = getReader(Astro.locals.runtime?.env?.GITHUB_TOKEN);
    const settings = await reader.singletons.settings.read();
    if (settings) {
        kvkkContent = await settings.kvkkText();
    }
} catch (e) {
    console.error("KVKK read error:", e);
}
---

<BaseLayout title="KVKK Aydınlatma Metni — NetMimar">
    <section class="py-20 bg-surface">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <nav class="mb-8 text-sm text-text-muted">
                <a href="/" class="hover:text-primary transition-colors"
                    >Ana Sayfa</a
                >
                <span class="mx-2">›</span>
                <span class="text-primary">KVKK Aydınlatma Metni</span>
            </nav>

            <h1 class="text-3xl sm:text-4xl font-bold text-primary mb-8">
                KVKK Aydınlatma Metni
            </h1>

            <div class="prose prose-lg max-w-none">
                {
                    kvkkContent ? (
                        <DocumentRenderer document={kvkkContent} />
                    ) : (
                        <p class="text-text-muted">
                            KVKK aydınlatma metni henüz eklenmemiş.
                        </p>
                    )
                }
            </div>
        </div>
    </section>
</BaseLayout>
